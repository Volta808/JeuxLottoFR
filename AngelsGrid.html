<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grille</title>
</head>
<body>
    <p id="genere" style="visibility: hidden;"></p>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <div id="photo">
        <h1 id="titre">Grilles de Lyfe  
        <img src="https://media.discordapp.net/attachments/487403255329194024/1071222606407155792/licorne-emoji-avec-des-coeurs-unicorn-emoji-autocollant-removebg-preview.png" id="screenshot-button" alt="Image indisponible"/>
        </h1> 
        <div style="text-align: center; margin-top: 40px;">
    <table class="tableau boxRose tableau1">
    <tbody id="tableau1">
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>

    </tbody>   
    </table>

    <table class="tableau boxVert">
        <tbody id="tableau2">
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
    
        </tbody>   
        </table>
    </div>
    <div style="text-align: center;">
        <table class="tableau boxViolet">
        <tbody id="tableau3">
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
    
        </tbody>   
        </table>
    
        <table class="tableau boxBleu">
            <tbody id="tableau4">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
        
            </tbody>   
            </table>
        </div>

        <div style="text-align: center;">
            <table class="tableau boxRouge">
            <tbody id="tableau5">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
        
            </tbody>   
            </table>
        
            <table class="tableau boxJaune">
                <tbody id="tableau6">
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
            
                </tbody>   
                </table>
            </div>
    </div>


<br>
<a id="downloadButton" onclick="this.href='data:text/html;charset=UTF-8,'+encodeURIComponent(document.documentElement.outerHTML)" href="#"><img width="65px" height="65px" src="https://media.discordapp.net/attachments/487403255329194024/1083215953971646505/632-6325136_cat-drawing-pusheen-food-artwork-png-image-with-removebg-preview.png" alt="Image indisponible"></a>
<a id="reset" href="#"><img width="96px" height="96px" src="https://media.discordapp.net/attachments/487403255329194024/1083211721021333604/cutecake.png" alt="Image indisponible"></a>    
<script>
    document.getElementById("reset").addEventListener("click", function() {
    const userChoice = prompt("Êtes-vous certain de vouloir réinitialiser les grilles? (oui/non)");
    if(userChoice.toLowerCase() =="oui"){
    let efface = []
    localStorage.setItem("listeNombres", JSON.stringify(efface));
    location.reload();
    }
    });
    
    if(document.getElementById("genere").textContent==""){
    let nom = prompt("Nom :");
    var nbGrilles = prompt("Nombre de Grilles :");
    document.getElementById("titre").innerHTML = "Grilles de " + nom + ' <img src="https://media.discordapp.net/attachments/487403255329194024/1071222606407155792/licorne-emoji-avec-des-coeurs-unicorn-emoji-autocollant-removebg-preview.png" id="screenshot-button" alt="Image indisponible"/>'
    document.title = nom
    document.getElementById("downloadButton").download = nom + ".html"
    genererGrille("tableau1")
    genererGrille("tableau2")
    genererGrille("tableau3")
    genererGrille("tableau4")
    genererGrille("tableau5")
    genererGrille("tableau6")
}

    function genererGrille(id){
        
        let tables = [];
        let lesTableaux = document.getElementById(id)

        let mainArray = [];
        let usedRanges = [];

        for (let i = 0; i < 3; i++) {
            let subArray = [];
            let count = 0;
            while (subArray.length < 5 && count < 100) {
                let randomNumber = Math.floor(Math.random() * 99) + 1;
                let alreadyExists = false;
                let rangeExists = false;
                for (let j = 0; j < subArray.length; j++) {
                    if (subArray[j] === randomNumber || Math.floor(subArray[j] / 10) === Math.floor(randomNumber / 10)) {
                        alreadyExists = true;
                        break;
                    }
                }
                for (let k = 0; k < usedRanges.length; k++) {
                    if (Math.floor(randomNumber / 10) === usedRanges[k]) {
                        rangeExists = true;
                        break;
                    }
                }
                if (!alreadyExists && !rangeExists) {
                    subArray.push(randomNumber);
                    usedRanges.push(Math.floor(randomNumber / 10));
                }
                count++;
            }
            mainArray.push(subArray.sort(function (a, b) { return a - b; }));
        }
        var tableauPremier = []
        var contient1 = 0;
        while (mainArray[2].length < 5) {
            for (let i = 0; i < mainArray[2].length; i++) {
                tableauPremier.push(mainArray[2][i].toString()[0])
            }

            do {
                var numberRandom = Math.floor(Math.random() * 99) + 1
                if(contient1 == 0 && numberRandom.toString().length==1 && !mainArray[0].includes(numberRandom) && !mainArray[1].includes(numberRandom) && !mainArray[2].includes(numberRandom)){
                    contient1 = 1
                    break
                }
            } while (mainArray[2].includes(numberRandom) || numberRandom.toString().length < 2 || tableauPremier.includes(numberRandom.toString()[0]) || mainArray[0].includes(numberRandom) || mainArray[1].includes(numberRandom))
            mainArray[2].push(numberRandom)
        }
        mainArray[2] = mainArray[2].sort(function (a, b) { return a - b; });

        tables = mainArray;

        let tr = document.getElementById(id).children
        for(let j = 0; j < 3; j++){
            let childs = tr[j].children
            for(let i=0; i<10; i++){
                for(let k=0; k<5; k++){
                    if(tables[j][k].toString().length==1){
                    childs[0].textContent = tables[j][k]
                    }else if(i==tables[j][k].toString()[0]){
                        childs[i].textContent=tables[j][k]
                    }
            }

            }
        }
        document.getElementById("genere").textContent = "fait"

    }
    
    
    document.getElementById("screenshot-button").addEventListener("click", function() {
      html2canvas(document.getElementById("photo")).then(function(canvas) {
        canvas.toBlob(function(blob) {
          const objectURL = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = objectURL;
          a.download = "screenshot.png";
          a.click();
          URL.revokeObjectURL(objectURL);
        });
      });
    });

    var tableaux = document.getElementsByTagName("table")
    if(nbGrilles>0){
    for (let i = 0; i < tableaux.length; i++) {
        tableaux[i].style.visibility = "hidden";
    }}
    for (let j = 0; j < nbGrilles; j++) {
        tableaux[j].style.visibility = "visible";
        if(j==nbGrilles-1 && nbGrilles%2==1){
            tableaux[j].parentElement.style.textAlign = "center"
        }
    }

    for (let k = 0; k < 6; k++) {
        if(tableaux[k].style.visibility=="hidden"){
            tableaux[k].remove()
        }
    }

    
    </script>
</body>
</html>

<style>
*, ::before, ::after {
box-sizing: border-box;
margin: 0;
padding: 0;
}
body{
    background-image: url("https://media.discordapp.net/attachments/582112089405915136/1071300008781021294/WallpaperDog-10881780.jpg");
    /* background-image: url('https://media.discordapp.net/attachments/582112089405915136/1071299242628489246/wp8452284-simple-dark-wallpapers.jpg'); */
    background-size: 100% 100%;
    height: 100vh;
    font-family: Arial, Helvetica, sans-serif;
}
#screenshot-button{
    display: inline-block;
    width: 165px;
    height: 85;
    border-radius: 35px;
    vertical-align:middle;
    
}
#screenshot-button:hover{
    cursor: pointer;
    border: rgb(192, 35, 145) solid 2px;

}
.boxRouge{
    box-shadow: 0 5px 50px rgb(238, 95, 95);
}
#downloadButton{
    margin-left: 10px;
    margin-bottom: 10px;
    position: fixed;
    bottom: 0;
    padding: 13px;
}

#reset{
    margin-right: 10px;
    margin-bottom: 10px;
    position: fixed;
    bottom: 0;
    right: 0;
}
#reset:hover{
    border-radius: 20px;
    border: solid white 1px;
}
#downloadButton:hover{
    border-radius: 20px;
    border: solid white 1px;
}
@media (max-width: 1920px){
    body{
    zoom: 85%;
    }
}
.boxBleu{
    box-shadow: 0 5px 50px rgb(95, 169, 238);
}
.boxJaune{
    box-shadow: 0 5px 50px rgb(243, 255, 135);
}
.boxVert{
    box-shadow: 0 5px 50px rgb(155, 255, 135);
}
.boxRose{
    box-shadow: 0 5px 50px rgb(255, 135, 209);
}
.boxViolet{
    box-shadow: 0 5px 50px rgb(191, 135, 255);
}
.tableau{
    display: inline-table;
    background-color: lightgrey;
    border-collapse: collapse;
    min-width: 400px;
    width: auto;
    cursor: pointer;
    margin: 35px 35px;
    border: 2px solid rgb(47, 47, 156);
}
td{
    text-align: center;
    padding: 15px 20px;
    width: 75px;
    height: 75px;
    border:solid black 1px;
    min-width: 75px;
    min-height: 75px;
    font-weight: bold;
    font-size: 35px;
}
td:hover{
    background-color: rgb(163, 163, 163);
}
.clicked{
    color:rgb(192, 35, 145);
    background-color: rgb(163, 163, 163);
}
#numbers{
    margin-left: 30px;
}
#titre{
    text-shadow: 2px 2px #ffffff;
    font-style: italic;
    font-size: 80px;
    margin-top: 34px;
    text-align:center;
    color:rgb(192, 35, 145);
    
}
#leBouton{
    margin-top: 20px;
    width: 20em;  height: 5em;
    border-radius: 20px;
    font-size: large;
}
#leBouton:hover{
    cursor: pointer;
    font-weight: bold;
}
</style>

<script>
const tds = document.querySelectorAll("td");
let Lesnombres = JSON.parse(localStorage.getItem("listeNombres")) || [];
tds.forEach(td => {
    if(Lesnombres.includes(Array.prototype.indexOf.call(tds, td))){
        td.classList.add("clicked");
    }
});
tds.forEach(td => {
    console.log(Array.prototype.indexOf.call(tds, td));
  td.style.fontSize = "1.5em";
  td.addEventListener("click", function() {
    if(td.textContent!=""){
    let nombres = JSON.parse(localStorage.getItem("listeNombres")) || [];
    if(!nombres.includes(td.textContent) && !td.classList.contains("clicked")){
    nombres.push(Array.prototype.indexOf.call(tds, td))
    localStorage.setItem("listeNombres", JSON.stringify(nombres));
    td.classList.add("clicked");
    }else if(nombres.includes(Array.prototype.indexOf.call(tds, td)) && td.classList.contains("clicked")){
        td.classList.remove("clicked");
        var index = nombres.indexOf(Array.prototype.indexOf.call(tds, td));
        if (index !== -1) {
        nombres.splice(index, 1);
        }
        localStorage.setItem("listeNombres", JSON.stringify(nombres));
    }
}
  });
});
</script>
